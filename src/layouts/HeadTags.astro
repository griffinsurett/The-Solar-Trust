---
// src/layouts/Head.astro
---
<!-- Forward dataLayer.push before Partytown loads -->
<script>
  window.partytown = { forward: ['dataLayer.push'] };
</script>

<!-- Partytown: Initialize dataLayer in web worker -->
<script type="text/partytown">
  window.dataLayer = window.dataLayer || [];
  window.dataLayer.push({
    'gtm.start': new Date().getTime(),
    event: 'gtm.js'
  });
</script>

<!-- Partytown: Load GTM off the main thread -->
<script
  type="text/partytown"
  async
  src="https://www.googletagmanager.com/gtm.js?id=GTM-TFCXPM4R&l=dataLayer"
></script>
